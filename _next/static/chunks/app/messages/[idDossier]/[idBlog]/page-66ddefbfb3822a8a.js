(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[326],{188:(t,e,s)=>{"use strict";s.d(e,{P:()=>l,E:()=>c});var r=s(7828),i=s(1059),a=s(4650),n=s(730);class o{static mapToDossier(t){let e=new r.O;if(e.setId(t.id),e.setTitre(t.titre),e.setDescription(t.description),t.utilisateur){let s=new n._;s.setUsername(t.utilisateur.username),e.setUtilisateur(s)}return e}static mapToBlog(t){let e=new i.d;if(e.setId(t.id),e.setNom(t.titre||t.nom),e.setDateCreation(new Date(t.dateCreation)),t.utilisateur){let s=new n._;s.setUsername(t.utilisateur.username),e.setUtilisateur(s)}if(t.messages&&Array.isArray(t.messages)){let s=t.messages.map(t=>o.mapToMessage(t));e.setMessages(s)}return e}static mapToMessage(t){let e=new a.Q;e.setContenu(t.contenu),e.setDate(new Date(t.date));let s=new n._;return s.setUsername(t.utilisateur.username),e.setUtilisateur(s),e}}class u{async getAllDossiers(){let t="".concat(this.apiBaseUrl,"/dossiers/liste"),e=await fetch(t);if(!e.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des dossiers : ".concat(e.statusText));let s=await e.json(),r=[];return s.forEach(t=>{r.push(o.mapToDossier(t))}),r}async getBlogsForDossier(t){let e="".concat(this.apiBaseUrl,"/blogs/liste/").concat(t),s=await fetch(e);if(!s.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des blogs pour le dossier ".concat(t," : ").concat(s.statusText));let r=await s.json(),i=[];for(let t of r){let e=o.mapToBlog(t);i.push(e)}return i}async getMessagesForBlog(t,e){let s="".concat(this.apiBaseUrl,"/messages/liste/").concat(e,"/").concat(t),r=await fetch(s);if(!r.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des messages pour le blog ".concat(t," dans le dossier ").concat(e," : ").concat(r.statusText));let i=await r.json(),a=[];return i.forEach(t=>{a.push(o.mapToMessage(t))}),a}constructor(t){this.apiBaseUrl=t}}let l={I_BlogService:Symbol.for("I_BlogService")};class c{static get(t){return this.instances.has(t)||this.instances.set(t,this.createInstance(t)),this.instances.get(t)}static createInstance(t){if(t===l.I_BlogService)return new u("http://localhost:3001/api");throw Error("Interface inconnue pour factory : "+t.toString())}}c.instances=new Map},730:(t,e,s)=>{"use strict";s.d(e,{_:()=>r});class r{getUsername(){return this.username}setUsername(t){this.username=t}getMotDePasse(){return this.motDePasse}setMotDePasse(t){this.motDePasse=t}getEstAdmin(){return this.estAdmin}setEstAdmin(t){this.estAdmin=t}toJSON(){return{username:this.username,motDePasse:this.motDePasse,estAdmin:this.estAdmin}}static fromJSON(t){let e=new r;return e.setUsername(t.username),e.setMotDePasse(t.motDePasse),e.setEstAdmin(t.estAdmin),e}constructor(){this.username="",this.motDePasse="",this.estAdmin=!1}}},1059:(t,e,s)=>{"use strict";s.d(e,{d:()=>a});var r=s(4650),i=s(730);class a{getId(){return this.id}setId(t){this.id=t}getNom(){return this.nom}setNom(t){this.nom=t}getDateCreation(){return this.dateCreation}setDateCreation(t){this.dateCreation=t}getMessages(){return this.messages}setMessages(t){this.messages=t}getUtilisateur(){return this.utilisateur}setUtilisateur(t){this.utilisateur=t}getIdDossier(){return this.idDossier}setIdDossier(t){this.idDossier=t}toJSON(){return{id:this.id,nom:this.nom,dateCreation:this.dateCreation.toISOString(),messages:this.messages.map(t=>t.toJSON()),utilisateur:this.utilisateur.toJSON(),idDossier:this.idDossier}}static fromJSON(t){let e=new a;return e.setId(t.id),e.setNom(t.nom),e.setDateCreation(new Date(t.dateCreation)),e.setIdDossier(t.idDossier),e.setMessages(t.messages.map(t=>r.Q.fromJSON(t))),e.setUtilisateur(i._.fromJSON(t.utilisateur)),e}constructor(){this.id="",this.nom="",this.dateCreation=new Date,this.messages=[],this.utilisateur=new i._,this.idDossier=""}}},1885:(t,e,s)=>{Promise.resolve().then(s.bind(s,6278))},4650:(t,e,s)=>{"use strict";s.d(e,{Q:()=>i});var r=s(730);class i{getContenu(){return this.contenu}setContenu(t){this.contenu=t}getDate(){return this.date}setDate(t){this.date=t}getUtilisateur(){return this.utilisateur}setUtilisateur(t){this.utilisateur=t}toJSON(){return{contenu:this.contenu,date:this.date.toISOString(),utilisateur:this.utilisateur.toJSON()}}static fromJSON(t){let e=new i;return e.setContenu(t.contenu),e.setDate(new Date(t.date)),e.setUtilisateur(r._.fromJSON(t.utilisateur)),e}constructor(){this.contenu="",this.date=new Date,this.utilisateur=new r._}}},5170:(t,e,s)=>{"use strict";s.d(e,{A:()=>i});var r=s(4799);function i(t){let{message:e,type:s="info"}=t,i="";switch(s){case"error":i="bg-red-100 text-red-700 border border-red-400";break;case"loading":i="bg-blue-100 text-blue-700 border border-blue-400 animate-pulse";break;default:i="bg-gray-100 text-gray-700 border border-gray-300"}return(0,r.jsx)("div",{className:"".concat("rounded-md p-4 text-center text-lg font-semibold max-w-md mx-auto select-none"," ").concat(i),children:e})}},6278:(t,e,s)=>{"use strict";s.d(e,{default:()=>c});var r=s(4799);function i(t){let{message:e}=t,s="/assets/BlogVacare/Icones/".concat(e.getUtilisateur().getUsername(),".jpg"),i=e.getDate().toLocaleString("fr-FR");return(0,r.jsxs)("div",{className:"flex gap-4 rounded-lg bg-white shadow-sm transition-transform duration-300 hover:scale-[1.01] hover:shadow-lg",children:[(0,r.jsx)("div",{className:"flex-none w-2/12 bg-gradient-to-r from-gray-300/50 to-white flex justify-center p-1",children:(0,r.jsx)("img",{className:"w-24 h-24 rounded-full object-cover p-4",src:s,alt:"Avatar de ".concat(e.getUtilisateur().getUsername())})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col pr-2 p-4",children:[(0,r.jsx)("span",{className:"font-semibold text-primary-dark col border-b-2 border-gray-400/15",children:e.getUtilisateur().getUsername()}),(0,r.jsx)("p",{className:"bg-white p-2 rounded-md text-neutral-dark pr-5 whitespace-pre-line",children:e.getContenu()}),(0,r.jsxs)("span",{className:"text-xs text-neutral dark:text-neutral-dark mt-1 pl-2",children:["Post\xe9 le ",i]})]})]})}function a(t){let{messages:e}=t;return(0,r.jsx)("div",{className:"flex flex-col gap-3 p-4 mx-auto max-w-4xl",children:e.map(t=>(0,r.jsx)(i,{message:t},t.getDate().toISOString()+t.getUtilisateur()))})}var n=s(5170),o=s(4023),u=s(188),l=s(4650);function c(t){let{idDossier:e,idBlog:s,messagesPrecharges:i}=t,c=i?i.map(t=>l.Q.fromJSON(t)):[],[d,h]=(0,o.useState)(c||[]),[m,g]=(0,o.useState)(!i),[p,f]=(0,o.useState)(null),{messages:w,loading:D,error:x}=function(t,e){let[s,r]=(0,o.useState)([]),[i,a]=(0,o.useState)(!0),[n,l]=(0,o.useState)(null);return(0,o.useEffect)(()=>{async function s(){a(!0),l(null);try{let s=u.E.get(u.P.I_BlogService),i=await s.getMessagesForBlog(t,e);r(i)}catch(t){l(t)}finally{a(!1)}}t?e?s():(l(Error("Identifiant de dossier non fourni")),a(!1)):(l(Error("Identifiant de blog non fourni")),a(!1))},[t,e]),{messages:s,loading:i,error:n}}(s,e);return((0,o.useEffect)(()=>{i||(h(w),g(D),f(x))},[i,w,D,x]),m)?(0,r.jsx)(n.A,{message:"Chargement des messages...",type:"loading"}):p?(0,r.jsx)(n.A,{message:"Erreur : ".concat(p.message),type:"error"}):(0,r.jsx)(a,{messages:d})}},7828:(t,e,s)=>{"use strict";s.d(e,{O:()=>i});var r=s(730);class i{getId(){return this.id}setId(t){this.id=t}getTitre(){return this.titre}setTitre(t){this.titre=t}getDescription(){return this.description}setDescription(t){this.description=t}getUtilisateur(){return this.utilisateur}setUtilisateur(t){this.utilisateur=t}toJSON(){return{id:this.id,titre:this.titre,description:this.description,utilisateur:this.utilisateur.toJSON()}}static fromJSON(t){let e=new i;return e.setId(t.id),e.setTitre(t.titre),e.setDescription(t.description),e.setUtilisateur(r._.fromJSON(t.utilisateur)),e}constructor(){this.id="",this.titre="",this.description="",this.utilisateur=new r._}}}},t=>{t.O(0,[408,89,358],()=>t(t.s=1885)),_N_E=t.O()}]);