(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43,327],{857:(e,s,r)=>{Promise.resolve().then(r.bind(r,3053))},3053:(e,s,r)=>{"use strict";r.d(s,{default:()=>N});var n=r(4799),t=r(2218),a=r(1463),o=r.n(a),l=r(6886),i=r(8545),u=r(4023),c=r(5874),m=r(5294);function g(e){let{blog:s,slugDossier:r,suppressionHandler:t}=e,a=s.getDateCreation().toLocaleDateString("fr-FR"),g=(0,l.r)(),d=(0,i.k)(g),h="modern"==g?"":"/"+g,[x,p]=(0,u.useState)(!1),f=s.getElementSupprime();return(0,n.jsx)("div",{className:d.BlogItemConteneur,children:(0,n.jsxs)("div",{className:d.BlogItemSousConteneur,children:[(0,n.jsxs)("div",{className:d.BlogItemLienConteneur,children:[(0,n.jsx)(o(),{href:"".concat(h,"/messages/").concat(r,"/").concat(s.getSlug()),className:d.BlogItemLien,"aria-label":"Voir le blog ".concat(s.getNom()),children:s.getNom()}),t&&!f&&(0,n.jsxs)("div",{className:d.supprimerBtn,children:[(0,n.jsx)("button",{onClick:()=>p(!0),children:"Supprimer"}),(0,n.jsx)(c.A,{id:s.getId(),type:"blog",suppressionHandler:t,dialogBoxOuverte:x,setDialogBox:p})]})]}),(0,n.jsxs)("span",{className:d.BlogItemSpan,children:["Cr\xe9\xe9 le ",a," par ",(0,n.jsx)("strong",{children:s.getUtilisateur().getUsername()})]}),(0,n.jsx)("p",{className:d.BlogItemContenu,children:s.getMessages()[0].getContenu()}),f&&(0,n.jsx)(m.A,{type:"blog",donnees:f})]})})}function d(e){let{blogs:s,slugDossier:r,suppressionHandler:t}=e,a=(0,l.r)(),o=(0,i.k)(a);if(s.length>0)return(0,n.jsx)("div",{className:o.listeBlogsConteneur,children:s.map(e=>(0,n.jsx)(g,{blog:e,slugDossier:r,suppressionHandler:t},e.getId()))})}var h=r(1059),x=r(5030);function p(e){let{onSubmit:s,chargement:r,erreur:t,estConnecte:a}=e,[o,c]=(0,u.useState)(""),[m,g]=(0,u.useState)(""),d=(0,l.r)(),h=(0,i.k)(d),p=async e=>{e.preventDefault(),await s(o,m),c(""),g("")};return a?(0,n.jsx)("section",{className:"mx-auto px-4 py-5 max-w-4xl",children:(0,n.jsxs)("form",{onSubmit:p,className:h.formContainer,children:[(0,n.jsx)("h3",{className:h.formH3,children:"old"==d?"Cr\xe9e ton blog !":"Cr\xe9er un nouveau blog"}),t&&(0,n.jsx)("div",{className:h.messageFormDiv,children:t.message}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"nom",className:h.formLabel,children:"Nom du blog"}),(0,n.jsx)("input",{id:"nom",type:"text",value:o,onChange:e=>c(e.target.value),maxLength:255,className:h.formInput,required:!0}),(0,n.jsx)("label",{htmlFor:"premierMessage",className:h.formLabel,children:"Premier message du blog :"}),(0,n.jsx)("textarea",{id:"premierMessage",value:m,onChange:e=>g(e.target.value),rows:3,className:h.formInput,required:!0}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)("button",{type:"submit",disabled:r,className:h.formBouton,children:r?"Cr\xe9ation en cours...":"old"==d?"Cr\xe9er ton blog !":"Cr\xe9er le blog"})})]})]})}):(0,n.jsx)(x.I,{message:"Vous devez \xeatre connect\xe9 pour cr\xe9er un blog."})}var f=r(1527),b=r(6911),j=r(4216),v=r(1545);function N(e){var s;let{slugDossier:r,blogsPrecharges:a}=e,o=(0,l.r)(),{donnees:i,chargement:u,erreur:c,refetch:m}=(0,t.R0)(r,o),{donnees:g}=(0,b.F_)(r),{mutation:x,chargement:N,erreur:C}=(0,t.Jx)(),{mutation:S}=(0,t.zU)(),{estConnecte:I,utilisateur:D}=(0,f.S)(),{donnees:B,chargement:w,erreur:y}=(0,j.T)(i,u,c,a,h.d.fromJSON),_=async(e,s)=>{if(!g)throw Error("Identifiant du dossier manquant");await x(e,s,g.getId()),m()},k=async(e,s,r)=>{await S(e,s,r),m()},L=null!=(s=null==D?void 0:D.getEstAdmin())&&s;return(0,n.jsxs)(v.f,{chargement:w,erreur:y,estVide:0==B.length,messageVide:"Aucun blog trouv\xe9",chargementMessage:"Chargement des blogs...",children:[(0,n.jsx)(p,{onSubmit:_,chargement:N,erreur:C,estConnecte:I}),(0,n.jsx)(d,{blogs:B,slugDossier:r,suppressionHandler:L?k:void 0})]})}},6911:(e,s,r)=>{"use strict";r.d(s,{F_:()=>i,Ge:()=>c,Gm:()=>u,Ox:()=>l});var n=r(1087),t=r(8384),a=r(1057);let o=n.E.get(n.I.I_DossierService);function l(e){return(0,a.S)(()=>o.recupererDossiers(e),[])}function i(e){return(0,a.S)(e=>o.recupererDossierParSlug(e),[e],{actif:!!e})}function u(){return(0,t.L)(async(e,s)=>{await o.creerDossier(e,s)})}function c(){return(0,t.L)(async(e,s,r)=>{await o.supprimerDossier(e,s,r)})}}},e=>{e.O(0,[463,862,398,306,408,89,358],()=>e(e.s=857)),_N_E=e.O()}]);