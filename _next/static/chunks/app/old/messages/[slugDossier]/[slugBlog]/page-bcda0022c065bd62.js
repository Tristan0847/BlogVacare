(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[532,712],{821:(e,s,a)=>{Promise.resolve().then(a.bind(a,9261))},9261:(e,s,a)=>{"use strict";a.d(s,{default:()=>C});var r=a(4799),t=a(4023),n=a(5030),o=a(6886),l=a(8545);function i(e){let{onSubmit:s,chargement:a,erreur:i,estConnecte:c}=e,[m,u]=(0,t.useState)(""),d=(0,o.r)(),g=(0,l.k)(d),p=async e=>{e.preventDefault(),await s(m),u("")};return c?(0,r.jsx)("section",{className:"mx-auto px-4 py-5 max-w-4xl",children:(0,r.jsxs)("form",{onSubmit:p,className:g.formContainer,children:[(0,r.jsx)("h3",{className:g.formH3,children:"old"==d?"Ajoute ta r\xe9ponse au blog !":"R\xe9pondre"}),i&&(0,r.jsx)("div",{className:g.messageFormDiv,children:i.message}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"nom",className:g.formLabel,children:"Votre r\xe9ponse :"}),(0,r.jsx)("textarea",{id:"nom",rows:4,value:m,onChange:e=>u(e.target.value),className:g.formInput,required:!0}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsx)("button",{type:"submit",disabled:a,className:g.formBouton,children:a?"R\xe9ponse en cours...":"R\xe9pondre au blog"})})]})]})}):(0,r.jsx)(n.I,{message:"Vous devez \xeatre connect\xe9 pour r\xe9pondre \xe0 un blog."})}var c=a(2371),m=a(9348),u=a(5874),d=a(5294);function g(e){let{message:s,suppressionHandler:a}=e,n="/assets/BlogVacare/Icones/".concat(s.getUtilisateur().getUsername(),".jpg"),[i,g]=(0,t.useState)(n),[p,h]=(0,t.useState)(!1),x=s.getDate().toLocaleString("fr-FR"),j=(0,o.r)(),v=(0,l.k)(j),[f,N]=(0,t.useState)(!1),b=s.getElementSupprime();return(0,r.jsxs)("div",{className:v.messageItem,children:[(0,r.jsx)("div",{className:v.messageImgConteneur,children:(0,r.jsx)(c.default,{className:v.messageImg,src:i,alt:"Avatar de ".concat(s.getUtilisateur().getUsername()),width:64,height:64,onError:()=>g("/assets/BlogVacare/Icones/Vince.jpg")})}),(0,r.jsxs)("div",{className:v.messageConteneur,children:[(0,r.jsxs)("span",{className:v.messagecontenuPseudo+" columns-2",children:[(0,r.jsx)("div",{className:"text-left",children:s.getUtilisateur().getUsername()}),a&&!b&&(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("button",{onClick:()=>N(!0),className:v.supprimerBtn,children:"Supprimer"}),(0,r.jsx)(u.A,{id:s.getId().toString(),type:"message",suppressionHandler:a,dialogBoxOuverte:f,setDialogBox:N})]})]}),b?(0,r.jsxs)("div",{className:v.messageSupprimeBox,children:[(0,r.jsx)(d.A,{type:"message",donnees:b}),(0,r.jsx)("button",{onClick:()=>h(!p),className:v.messageSupprimeBtn,children:p?"Masquer":"Voir quand m\xeame"}),p&&(0,r.jsx)("div",{className:"".concat(v.messageContenu," mt-3 opacity-90"),children:(0,r.jsx)(m.oz,{components:{a:e=>{let{...s}=e;return(0,r.jsx)("a",{...s,className:"underline hover:font-bold",target:"_blank",rel:"noopener noreferrer"})}},children:s.getContenu()})})]}):(0,r.jsx)("div",{className:v.messageContenu,children:(0,r.jsx)(m.oz,{components:{a:e=>{let{...s}=e;return(0,r.jsx)("a",{...s,className:"underline hover:font-bold",target:"_blank",rel:"noopener noreferrer"})}},children:s.getContenu()})}),(0,r.jsxs)("span",{className:v.messageDate,children:["Post\xe9 le ",x]})]})]})}function p(e){let{messages:s,suppressionHandler:a}=e,t=(0,o.r)(),n=(0,l.k)(t);return(0,r.jsx)("div",{className:n.messageList,children:s.map(e=>(0,r.jsx)(g,{message:e,suppressionHandler:a},e.getDate().toISOString()+e.getUtilisateur()))})}var h=a(1545),x=a(1527),j=a(2218),v=a(4216),f=a(1087),N=a(8384),b=a(1057);let S=f.E.get(f.I.I_MessageService);var I=a(4650);function C(e){var s;let{slugDossier:a,slugBlog:t,messagesPrecharges:n}=e,l=(0,o.r)(),{donnees:c,chargement:m,erreur:u,refetch:d}=(0,b.S)((e,s)=>S.recupererMessagesDuBlog(e,s,l),[a,t],{actif:!!a&&!!t}),{donnees:g}=(0,j.Ux)(a,t),{mutation:f,chargement:C,erreur:w}=(0,N.L)(async(e,s)=>{await S.creerMessage(e,s)}),{mutation:k}=(0,N.L)(async(e,s,a,r)=>{await S.supprimerMessage(e,s,a,r)}),{estConnecte:y,utilisateur:B}=(0,x.S)(),{donnees:E,chargement:_,erreur:U}=(0,v.T)(c,m,u,n,I.Q.fromJSON),V=async e=>{if(!g)throw Error("Identifiant du blog manquant");await f(e,g.getId()),d()},D=async(e,s,a)=>{if(!g)throw Error("Identifiant du blog manquant");let r=parseInt(e);await k(r,g.getId(),s,a),d()},A=null!=(s=null==B?void 0:B.getEstAdmin())&&s;return(0,r.jsxs)(h.f,{chargement:_,erreur:U,estVide:0==E.length,messageVide:"Aucun message trouv\xe9",chargementMessage:"Chargement des messages...",children:[(0,r.jsx)(p,{messages:E,suppressionHandler:A?D:void 0}),(0,r.jsx)(i,{onSubmit:V,chargement:C,erreur:w,estConnecte:y})]})}}},e=>{e.O(0,[463,862,371,348,398,306,408,89,358],()=>e(e.s=821)),_N_E=e.O()}]);