(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[532,712],{821:(e,s,r)=>{Promise.resolve().then(r.bind(r,9261))},2218:(e,s,r)=>{"use strict";r.d(s,{Jx:()=>c,R0:()=>i,Ux:()=>l,zU:()=>u});var a=r(1087),t=r(8384),n=r(1057);let o=a.E.get(a.I.I_BlogService);function i(e){return(0,n.S)(e=>o.recupererBlogsDuDossier(e),[e],{actif:!!e})}function l(e,s){return(0,n.S)((e,s)=>o.recupererBlogParSlug(e,s),[s,e],{actif:!!e&&!!s})}function c(){return(0,t.L)(async(e,s,r)=>{await o.creerBlog(e,s,r)})}function u(){return(0,t.L)(async(e,s,r)=>{await o.supprimerBlog(e,s,r)})}},9261:(e,s,r)=>{"use strict";r.d(s,{default:()=>B});var a=r(4799),t=r(7104),n=r(4023),o=r(5030),i=r(6886),l=r(8545);function c(e){let{onSubmit:s,chargement:r,erreur:t,estConnecte:c}=e,[u,m]=(0,n.useState)(""),g=(0,i.r)(),d=(0,l.k)(g),p=async e=>{e.preventDefault(),await s(u),m("")};return c?(0,a.jsx)("section",{className:"mx-auto px-4 py-5 max-w-4xl",children:(0,a.jsxs)("form",{onSubmit:p,className:d.formContainer,children:[(0,a.jsx)("h3",{className:d.formH3,children:"old"==g?"Ajoute ta r\xe9ponse au blog !":"R\xe9pondre"}),t&&(0,a.jsx)("div",{className:d.messageFormDiv,children:t.message}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"nom",className:d.formLabel,children:"Votre r\xe9ponse :"}),(0,a.jsx)("textarea",{id:"nom",rows:4,value:u,onChange:e=>m(e.target.value),className:d.formInput,required:!0}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)("button",{type:"submit",disabled:r,className:d.formBouton,children:r?"R\xe9ponse en cours...":"R\xe9pondre au blog"})})]})]})}):(0,a.jsx)(o.I,{message:"Vous devez \xeatre connect\xe9 pour r\xe9pondre \xe0 un blog."})}var u=r(2371),m=r(9348),g=r(5874),d=r(5294);function p(e){let{message:s,suppressionHandler:r}=e,t="/assets/BlogVacare/Icones/".concat(s.getUtilisateur().getUsername(),".jpg"),[o,c]=(0,n.useState)(t),[p,x]=(0,n.useState)(!1),h=s.getDate().toLocaleString("fr-FR"),j=(0,i.r)(),f=(0,l.k)(j),[v,N]=(0,n.useState)(!1),S=s.getElementSupprime();return(0,a.jsxs)("div",{className:f.messageItem,children:[(0,a.jsx)("div",{className:f.messageImgConteneur,children:(0,a.jsx)(u.default,{className:f.messageImg,src:o,alt:"Avatar de ".concat(s.getUtilisateur().getUsername()),width:96,height:96,onError:()=>c("/assets/BlogVacare/Icones/Vince.jpg")})}),(0,a.jsxs)("div",{className:f.messageConteneur,children:[(0,a.jsxs)("span",{className:f.messagecontenuPseudo+" columns-2",children:[(0,a.jsx)("div",{className:"text-left",children:s.getUtilisateur().getUsername()}),r&&!S&&(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("button",{onClick:()=>N(!0),className:f.supprimerBtn,children:"Supprimer"}),(0,a.jsx)(g.A,{id:s.getId().toString(),type:"message",suppressionHandler:r,dialogBoxOuverte:v,setDialogBox:N})]})]}),S?(0,a.jsxs)("div",{className:f.messageSupprimeBox,children:[(0,a.jsx)(d.A,{type:"message",donnees:S}),(0,a.jsx)("button",{onClick:()=>x(!p),className:f.messageSupprimeBtn,children:p?"Masquer":"Voir quand m\xeame"}),p&&(0,a.jsx)("div",{className:"".concat(f.messageContenu," mt-3 opacity-90"),children:(0,a.jsx)(m.oz,{components:{a:e=>{let{node:s,...r}=e;return(0,a.jsx)("a",{...r,className:"underline hover:font-bold",target:"_blank",rel:"noopener noreferrer"})}},children:s.getContenu()})})]}):(0,a.jsx)("div",{className:f.messageContenu,children:(0,a.jsx)(m.oz,{components:{a:e=>{let{node:s,...r}=e;return(0,a.jsx)("a",{...r,className:"underline hover:font-bold",target:"_blank",rel:"noopener noreferrer"})}},children:s.getContenu()})}),(0,a.jsxs)("span",{className:f.messageDate,children:["Post\xe9 le ",h]})]})]})}function x(e){let{messages:s,suppressionHandler:r}=e,t=(0,i.r)(),n=(0,l.k)(t);return(0,a.jsx)("div",{className:n.messageList,children:s.map(e=>(0,a.jsx)(p,{message:e,suppressionHandler:r},e.getDate().toISOString()+e.getUtilisateur()))})}var h=r(1545),j=r(1527),f=r(2218),v=r(4216),N=r(1087),S=r(8384),b=r(1057);let I=N.E.get(N.I.I_MessageService);var w=r(4650);function B(e){var s;let{slugDossier:r,slugBlog:n,messagesPrecharges:o}=e,{donnees:l,chargement:u,erreur:m,refetch:g}=(0,b.S)((e,s)=>I.recupererMessagesDuBlog(e,s),[r,n],{actif:!!r&&!!n}),{donnees:d}=(0,f.Ux)(r,n),{mutation:p,chargement:N,erreur:B}=(0,S.L)(async(e,s)=>{await I.creerMessage(e,s)}),{mutation:C}=(0,S.L)(async(e,s,r,a)=>{await I.supprimerMessage(e,s,r,a)}),{estConnecte:y,utilisateur:k}=(0,j.S)(),{donnees:E,chargement:U,erreur:_}=(0,v.T)(l,u,m,o,w.Q.fromJSON),D=(0,i.r)(),V=async e=>{if(!d)throw Error("Identifiant du blog manquant");await p(e,d.getId()),g()},L=async(e,s,r)=>{if(!d)throw Error("Identifiant du blog manquant");let a=parseInt(e);await C(a,d.getId(),s,r),g()},M=null!=(s=null==k?void 0:k.getEstAdmin())&&s,A=M?L:void 0,q=(0,t.M)(E,M,D);return(0,a.jsxs)(h.f,{chargement:U,erreur:_,estVide:0==E.length,messageVide:"Aucun message trouv\xe9",chargementMessage:"Chargement des messages...",children:[(0,a.jsx)(x,{messages:q,suppressionHandler:A}),(0,a.jsx)(c,{onSubmit:V,chargement:N,erreur:B,estConnecte:y})]})}}},e=>{e.O(0,[463,862,371,348,398,572,408,89,358],()=>e(e.s=821)),_N_E=e.O()}]);