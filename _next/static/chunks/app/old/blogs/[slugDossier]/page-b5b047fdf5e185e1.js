(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43,327],{857:(e,r,s)=>{Promise.resolve().then(s.bind(s,3053))},2218:(e,r,s)=>{"use strict";s.d(r,{Jx:()=>u,R0:()=>l,Ux:()=>i,zU:()=>c});var n=s(1087),t=s(8384),a=s(1057);let o=n.E.get(n.I.I_BlogService);function l(e){return(0,a.S)(e=>o.recupererBlogsDuDossier(e),[e],{actif:!!e})}function i(e,r){return(0,a.S)((e,r)=>o.recupererBlogParSlug(e,r),[r,e],{actif:!!e&&!!r})}function u(){return(0,t.L)(async(e,r,s)=>{await o.creerBlog(e,r,s)})}function c(){return(0,t.L)(async(e,r,s)=>{await o.supprimerBlog(e,r,s)})}},3053:(e,r,s)=>{"use strict";s.d(r,{default:()=>C});var n=s(4799),t=s(2218),a=s(1463),o=s.n(a),l=s(6886),i=s(8545),u=s(4023),c=s(5874),m=s(5294);function g(e){let{blog:r,slugDossier:s,suppressionHandler:t}=e,a=r.getDateCreation().toLocaleDateString("fr-FR"),g=(0,l.r)(),d=(0,i.k)(g),p="modern"==g?"":"/"+g,[x,h]=(0,u.useState)(!1),f=r.getElementSupprime();return(0,n.jsx)("div",{className:d.BlogItemConteneur,children:(0,n.jsxs)("div",{className:d.BlogItemSousConteneur,children:[(0,n.jsxs)("div",{className:d.BlogItemLienConteneur,children:[(0,n.jsx)(o(),{href:"".concat(p,"/messages/").concat(s,"/").concat(r.getSlug()),className:d.BlogItemLien,"aria-label":"Voir le blog ".concat(r.getNom()),children:r.getNom()}),t&&!f&&(0,n.jsxs)("div",{className:d.supprimerBtn,children:[(0,n.jsx)("button",{onClick:()=>h(!0),children:"Supprimer"}),(0,n.jsx)(c.A,{id:r.getId(),type:"blog",suppressionHandler:t,dialogBoxOuverte:x,setDialogBox:h})]})]}),(0,n.jsxs)("span",{className:d.BlogItemSpan,children:["Cr\xe9\xe9 le ",a," par ",(0,n.jsx)("strong",{children:r.getUtilisateur().getUsername()})]}),(0,n.jsx)("p",{className:d.BlogItemContenu,children:r.getMessages()[0].getContenu()}),f&&(0,n.jsx)(m.A,{type:"blog",donnees:f})]})})}function d(e){let{blogs:r,slugDossier:s,suppressionHandler:t}=e,a=(0,l.r)(),o=(0,i.k)(a);return(0,n.jsx)("div",{className:o.listeBlogsConteneur,children:r.map(e=>(0,n.jsx)(g,{blog:e,slugDossier:s,suppressionHandler:t},e.getId()))})}var p=s(1059),x=s(5030);function h(e){let{onSubmit:r,chargement:s,erreur:t,estConnecte:a}=e,[o,c]=(0,u.useState)(""),[m,g]=(0,u.useState)(""),d=(0,l.r)(),p=(0,i.k)(d),h=async e=>{e.preventDefault(),await r(o,m),c(""),g("")};return a?(0,n.jsx)("section",{className:"mx-auto px-4 py-5 max-w-4xl",children:(0,n.jsxs)("form",{onSubmit:h,className:p.formContainer,children:[(0,n.jsx)("h3",{className:p.formH3,children:"old"==d?"Cr\xe9e ton blog !":"Cr\xe9er un nouveau blog"}),t&&(0,n.jsx)("div",{className:p.messageFormDiv,children:t.message}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"nom",className:p.formLabel,children:"Nom du blog"}),(0,n.jsx)("input",{id:"nom",type:"text",value:o,onChange:e=>c(e.target.value),maxLength:255,className:p.formInput,required:!0}),(0,n.jsx)("label",{htmlFor:"premierMessage",className:p.formLabel,children:"Premier message du blog :"}),(0,n.jsx)("textarea",{id:"premierMessage",value:m,onChange:e=>g(e.target.value),rows:3,className:p.formInput,required:!0}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)("button",{type:"submit",disabled:s,className:p.formBouton,children:s?"Cr\xe9ation en cours...":"old"==d?"Cr\xe9er ton blog !":"Cr\xe9er le blog"})})]})]})}):(0,n.jsx)(x.I,{message:"Vous devez \xeatre connect\xe9 pour cr\xe9er un blog."})}var f=s(1527),v=s(6911),b=s(4216),j=s(1545),N=s(7104);function C(e){var r;let{slugDossier:s,blogsPrecharges:a}=e,{donnees:o,chargement:i,erreur:u,refetch:c}=(0,t.R0)(s),{donnees:m}=(0,v.F_)(s),{mutation:g,chargement:x,erreur:C}=(0,t.Jx)(),{mutation:S}=(0,t.zU)(),{estConnecte:I,utilisateur:B}=(0,f.S)(),{donnees:D,chargement:w,erreur:y}=(0,b.T)(o,i,u,a,p.d.fromJSON),L=(0,l.r)(),_=async(e,r)=>{if(!m)throw Error("Identifiant du dossier manquant");await g(e,r,m.getId()),c()},k=async(e,r,s)=>{await S(e,r,s),c()},E=null!=(r=null==B?void 0:B.getEstAdmin())&&r,F=E?k:void 0,M=(0,N.M)(D,E,L);return(0,n.jsxs)(j.f,{chargement:w,erreur:y,estVide:0==D.length,messageVide:"Aucun blog trouv\xe9",chargementMessage:"Chargement des blogs...",children:[(0,n.jsx)(h,{onSubmit:_,chargement:x,erreur:C,estConnecte:I}),(0,n.jsx)(d,{blogs:M,slugDossier:s,suppressionHandler:F})]})}},6911:(e,r,s)=>{"use strict";s.d(r,{F_:()=>i,Ge:()=>c,Gm:()=>u,Ox:()=>l});var n=s(1087),t=s(8384),a=s(1057);let o=n.E.get(n.I.I_DossierService);function l(){return(0,a.S)(()=>o.recupererDossiers(),[])}function i(e){return(0,a.S)(e=>o.recupererDossierParSlug(e),[e],{actif:!!e})}function u(){return(0,t.L)(async(e,r)=>{await o.creerDossier(e,r)})}function c(){return(0,t.L)(async(e,r,s)=>{await o.supprimerDossier(e,r,s)})}}},e=>{e.O(0,[463,862,398,572,408,89,358],()=>e(e.s=857)),_N_E=e.O()}]);