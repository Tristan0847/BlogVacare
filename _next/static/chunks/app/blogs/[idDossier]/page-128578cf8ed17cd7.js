(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[555],{188:(t,e,s)=>{"use strict";s.d(e,{P:()=>l,E:()=>c});var r=s(7828),i=s(1059),a=s(4650),n=s(730);class o{static mapToDossier(t){let e=new r.O;if(e.setId(t.id),e.setTitre(t.titre),e.setDescription(t.description),t.utilisateur){let s=new n._;s.setUsername(t.utilisateur.username),e.setUtilisateur(s)}return e}static mapToBlog(t){let e=new i.d;if(e.setId(t.id),e.setNom(t.titre||t.nom),e.setDateCreation(new Date(t.dateCreation)),t.utilisateur){let s=new n._;s.setUsername(t.utilisateur.username),e.setUtilisateur(s)}if(t.messages&&Array.isArray(t.messages)){let s=t.messages.map(t=>o.mapToMessage(t));e.setMessages(s)}return e}static mapToMessage(t){let e=new a.Q;e.setContenu(t.contenu),e.setDate(new Date(t.date));let s=new n._;return s.setUsername(t.utilisateur.username),e.setUtilisateur(s),e}}class u{async getAllDossiers(){let t="".concat(this.apiBaseUrl,"/dossiers/liste"),e=await fetch(t);if(!e.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des dossiers : ".concat(e.statusText));let s=await e.json(),r=[];return s.forEach(t=>{r.push(o.mapToDossier(t))}),r}async getBlogsForDossier(t){let e="".concat(this.apiBaseUrl,"/blogs/liste/").concat(t),s=await fetch(e);if(!s.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des blogs pour le dossier ".concat(t," : ").concat(s.statusText));let r=await s.json(),i=[];for(let t of r){let e=o.mapToBlog(t);i.push(e)}return i}async getMessagesForBlog(t,e){let s="".concat(this.apiBaseUrl,"/messages/liste/").concat(e,"/").concat(t),r=await fetch(s);if(!r.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des messages pour le blog ".concat(t," dans le dossier ").concat(e," : ").concat(r.statusText));let i=await r.json(),a=[];return i.forEach(t=>{a.push(o.mapToMessage(t))}),a}constructor(t){this.apiBaseUrl=t}}let l={I_BlogService:Symbol.for("I_BlogService")};class c{static get(t){return this.instances.has(t)||this.instances.set(t,this.createInstance(t)),this.instances.get(t)}static createInstance(t){if(t===l.I_BlogService)return new u("http://localhost:3001/api");throw Error("Interface inconnue pour factory : "+t.toString())}}c.instances=new Map},606:(t,e,s)=>{"use strict";s.d(e,{default:()=>h});var r=s(4799),i=s(4023),a=s(188),n=s(1463),o=s.n(n);function u(t){let{blog:e,idDossier:s}=t,i=e.getDateCreation().toLocaleDateString("fr-FR");return(0,r.jsx)("div",{className:"p-4 border border-neutral-light rounded-md shadow-sm hover:shadow-md transition-shadow cursor-pointer bg-white max-w-md",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)(o(),{href:"/messages/".concat(s,"/").concat(e.getId()),className:"text-lg font-semibold text-primary-dark hover:underline border-b-2 border-primary-dark/50 pb-1","aria-label":"Voir le blog ".concat(e.getNom()),children:e.getNom()}),(0,r.jsxs)("span",{className:"text-sm text-neutral-dark italic",children:["Cr\xe9\xe9 le ",i," par ",(0,r.jsx)("strong",{children:e.getUtilisateur().getUsername()})]}),(0,r.jsx)("p",{className:"text-neutral-700 mt-2 line-clamp-4",children:e.getMessages()[0].getContenu()})]})})}function l(t){let{blogs:e,idDossier:s}=t;return(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-2 bg-white border-2 border-stone-200/10 rounded-lg shadow-primary-dark/80 max-w-4xl mx-auto",children:e.map(t=>(0,r.jsx)(u,{blog:t,idDossier:s},t.getId()))})}var c=s(5170),d=s(1059);function h(t){let{idDossier:e,blogsPrecharges:s}=t,n=s?s.map(t=>d.d.fromJSON(t)):[],[o,u]=(0,i.useState)(n||[]),[h,m]=(0,i.useState)(!s),[g,p]=(0,i.useState)(null),{blogs:f,loading:D,error:w}=function(t){let[e,s]=(0,i.useState)([]),[r,n]=(0,i.useState)(!0),[o,u]=(0,i.useState)(null);return(0,i.useEffect)(()=>{async function e(){n(!0),u(null);try{let e=a.E.get(a.P.I_BlogService),r=await e.getBlogsForDossier(t);s(r)}catch(t){u(t)}finally{n(!1)}}t?e():(u(Error("Identifiant de dossier non fourni")),n(!1))},[t]),{blogs:e,loading:r,error:o}}(e);return((0,i.useEffect)(()=>{s||(u(f),m(D),p(w))},[s,f,D,w]),h)?(0,r.jsx)(c.A,{message:"Chargement des blogs...",type:"loading"}):g?(0,r.jsx)(c.A,{message:"Erreur : ".concat(g.message),type:"error"}):(0,r.jsx)(l,{blogs:o,idDossier:e})}},730:(t,e,s)=>{"use strict";s.d(e,{_:()=>r});class r{getUsername(){return this.username}setUsername(t){this.username=t}getMotDePasse(){return this.motDePasse}setMotDePasse(t){this.motDePasse=t}getEstAdmin(){return this.estAdmin}setEstAdmin(t){this.estAdmin=t}toJSON(){return{username:this.username,motDePasse:this.motDePasse,estAdmin:this.estAdmin}}static fromJSON(t){let e=new r;return e.setUsername(t.username),e.setMotDePasse(t.motDePasse),e.setEstAdmin(t.estAdmin),e}constructor(){this.username="",this.motDePasse="",this.estAdmin=!1}}},1059:(t,e,s)=>{"use strict";s.d(e,{d:()=>a});var r=s(4650),i=s(730);class a{getId(){return this.id}setId(t){this.id=t}getNom(){return this.nom}setNom(t){this.nom=t}getDateCreation(){return this.dateCreation}setDateCreation(t){this.dateCreation=t}getMessages(){return this.messages}setMessages(t){this.messages=t}getUtilisateur(){return this.utilisateur}setUtilisateur(t){this.utilisateur=t}getIdDossier(){return this.idDossier}setIdDossier(t){this.idDossier=t}toJSON(){return{id:this.id,nom:this.nom,dateCreation:this.dateCreation.toISOString(),messages:this.messages.map(t=>t.toJSON()),utilisateur:this.utilisateur.toJSON(),idDossier:this.idDossier}}static fromJSON(t){let e=new a;return e.setId(t.id),e.setNom(t.nom),e.setDateCreation(new Date(t.dateCreation)),e.setIdDossier(t.idDossier),e.setMessages(t.messages.map(t=>r.Q.fromJSON(t))),e.setUtilisateur(i._.fromJSON(t.utilisateur)),e}constructor(){this.id="",this.nom="",this.dateCreation=new Date,this.messages=[],this.utilisateur=new i._,this.idDossier=""}}},3791:(t,e,s)=>{Promise.resolve().then(s.bind(s,606))},4650:(t,e,s)=>{"use strict";s.d(e,{Q:()=>i});var r=s(730);class i{getContenu(){return this.contenu}setContenu(t){this.contenu=t}getDate(){return this.date}setDate(t){this.date=t}getUtilisateur(){return this.utilisateur}setUtilisateur(t){this.utilisateur=t}toJSON(){return{contenu:this.contenu,date:this.date.toISOString(),utilisateur:this.utilisateur.toJSON()}}static fromJSON(t){let e=new i;return e.setContenu(t.contenu),e.setDate(new Date(t.date)),e.setUtilisateur(r._.fromJSON(t.utilisateur)),e}constructor(){this.contenu="",this.date=new Date,this.utilisateur=new r._}}},5170:(t,e,s)=>{"use strict";s.d(e,{A:()=>i});var r=s(4799);function i(t){let{message:e,type:s="info"}=t,i="";switch(s){case"error":i="bg-red-100 text-red-700 border border-red-400";break;case"loading":i="bg-blue-100 text-blue-700 border border-blue-400 animate-pulse";break;default:i="bg-gray-100 text-gray-700 border border-gray-300"}return(0,r.jsx)("div",{className:"".concat("rounded-md p-4 text-center text-lg font-semibold max-w-md mx-auto select-none"," ").concat(i),children:e})}},7828:(t,e,s)=>{"use strict";s.d(e,{O:()=>i});var r=s(730);class i{getId(){return this.id}setId(t){this.id=t}getTitre(){return this.titre}setTitre(t){this.titre=t}getDescription(){return this.description}setDescription(t){this.description=t}getUtilisateur(){return this.utilisateur}setUtilisateur(t){this.utilisateur=t}toJSON(){return{id:this.id,titre:this.titre,description:this.description,utilisateur:this.utilisateur.toJSON()}}static fromJSON(t){let e=new i;return e.setId(t.id),e.setTitre(t.titre),e.setDescription(t.description),e.setUtilisateur(r._.fromJSON(t.utilisateur)),e}constructor(){this.id="",this.titre="",this.description="",this.utilisateur=new r._}}}},t=>{t.O(0,[463,408,89,358],()=>t(t.s=3791)),_N_E=t.O()}]);